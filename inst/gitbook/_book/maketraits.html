<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Simulating traits | Specific examples</title>
  <meta name="description" content="treats R package manual" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Simulating traits | Specific examples" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="treats R package manual" />
  <meta name="github-repo" content="TGuillerme/treats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Simulating traits | Specific examples" />
  
  <meta name="twitter:description" content="treats R package manual" />
  

<meta name="author" content="Thomas Guillerme (guillert@tcd.ie)" />


<meta name="date" content="2023-05-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gettingstarted.html"/>
<link rel="next" href="makemodifiers.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.1.3/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.1.3/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.1.3/rglClass.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/utils.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/buffer.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/subscenes.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/shaders.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/shadersrc.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/textures.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/projection.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/mouse.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/init.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/pieces.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/draw.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/controls.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/selection.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/rglTimer.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/pretty.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/axes.src.js"></script>
<script src="libs/rglwidgetClass-1.1.3/animation.src.js"></script>
<script src="libs/CanvasMatrix4-1.1.3/CanvasMatrix.src.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">treats manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <code>treats</code>: trees and traits simulations.</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-treats"><i class="fa fa-check"></i><b>1.1</b> What is <code>treats</code>?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#modular"><i class="fa fa-check"></i><b>1.1.1</b> Modular?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#who-is-this-manual-for"><i class="fa fa-check"></i><b>1.2</b> Who is this manual for?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-and-running-the-package"><i class="fa fa-check"></i><b>1.3</b> Installing and running the package</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.4</b> Help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#how-does-treats-work"><i class="fa fa-check"></i><b>1.5</b> How does <code>treats</code> work?</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#bdalgorithm"><i class="fa fa-check"></i><b>1.6</b> The birth-death algorithm</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gettingstarted.html"><a href="gettingstarted.html"><i class="fa fa-check"></i><b>2</b> Getting started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="gettingstarted.html"><a href="gettingstarted.html#the-simplest-analysis-simulating-diversity-only"><i class="fa fa-check"></i><b>2.1</b> The simplest analysis: simulating diversity only</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="gettingstarted.html"><a href="gettingstarted.html#changing-the-birth-death-parameters"><i class="fa fa-check"></i><b>2.1.1</b> Changing the birth-death parameters</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="gettingstarted.html"><a href="gettingstarted.html#slightly-more-complex-simulating-disparity-and-diversity"><i class="fa fa-check"></i><b>2.2</b> Slightly more complex: simulating disparity and diversity</a></li>
<li class="chapter" data-level="2.3" data-path="gettingstarted.html"><a href="gettingstarted.html#slightly-more-complex-again-simulating-linked-disparity-and-diversity"><i class="fa fa-check"></i><b>2.3</b> Slightly more complex again: simulating linked disparity and diversity</a></li>
<li class="chapter" data-level="2.4" data-path="gettingstarted.html"><a href="gettingstarted.html#kpgexample"><i class="fa fa-check"></i><b>2.4</b> An illustrative example: mammals disparity through the K-Pg extinction</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="gettingstarted.html"><a href="gettingstarted.html#simulating-trees-and-traits-using-the-observed-parameters"><i class="fa fa-check"></i><b>2.4.1</b> Simulating trees and traits using the observed parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="maketraits.html"><a href="maketraits.html"><i class="fa fa-check"></i><b>3</b> Simulating traits</a>
<ul>
<li class="chapter" data-level="3.1" data-path="maketraits.html"><a href="maketraits.html#the-process-process"><i class="fa fa-check"></i><b>3.1</b> The process (<code>process</code>)</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="maketraits.html"><a href="maketraits.html#the-syntax-how-to-code-a-process"><i class="fa fa-check"></i><b>3.1.1</b> The syntax (how to code a process?)</a></li>
<li class="chapter" data-level="3.1.2" data-path="maketraits.html"><a href="maketraits.html#using-a-process-in-treats"><i class="fa fa-check"></i><b>3.1.2</b> Using a <code>"process"</code> in <code>treats</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="maketraits.html"><a href="maketraits.html#the-number-of-traits-n-and-the-starting-values-start"><i class="fa fa-check"></i><b>3.2</b> The number of traits <code>n</code> and the starting values <code>start</code></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="maketraits.html"><a href="maketraits.html#what-is-a-trait-in-treats"><i class="fa fa-check"></i><b>3.2.1</b> What is a trait in <code>treats</code>?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="maketraits.html"><a href="maketraits.html#multidimensional-traits-and-correlations"><i class="fa fa-check"></i><b>3.3</b> Multidimensional traits and correlations</a></li>
<li class="chapter" data-level="3.4" data-path="maketraits.html"><a href="maketraits.html#extra-argument-for-the-processes-with-process.args"><i class="fa fa-check"></i><b>3.4</b> Extra argument for the processes with <code>process.args</code></a></li>
<li class="chapter" data-level="3.5" data-path="maketraits.html"><a href="maketraits.html#naming-the-traits-with-trait.names"><i class="fa fa-check"></i><b>3.5</b> Naming the traits with <code>trait.names</code></a></li>
<li class="chapter" data-level="3.6" data-path="maketraits.html"><a href="maketraits.html#combining-multiple-traits-with-add"><i class="fa fa-check"></i><b>3.6</b> Combining multiple traits with <code>add</code></a></li>
<li class="chapter" data-level="3.7" data-path="maketraits.html"><a href="maketraits.html#using-a-background-trait"><i class="fa fa-check"></i><b>3.7</b> Using a background trait</a></li>
<li class="chapter" data-level="3.8" data-path="maketraits.html"><a href="maketraits.html#saving-trait-values-at-different-time-steps"><i class="fa fa-check"></i><b>3.8</b> Saving trait values at different time steps</a></li>
<li class="chapter" data-level="3.9" data-path="maketraits.html"><a href="maketraits.html#traits-implemented-in-treats"><i class="fa fa-check"></i><b>3.9</b> Traits implemented in <code>treats</code></a></li>
<li class="chapter" data-level="3.10" data-path="maketraits.html"><a href="maketraits.html#testing-the-traits-with-test"><i class="fa fa-check"></i><b>3.10</b> Testing the traits with <code>test</code></a></li>
<li class="chapter" data-level="3.11" data-path="maketraits.html"><a href="maketraits.html#mapping-traits-on-a-tree-map.traits"><i class="fa fa-check"></i><b>3.11</b> Mapping traits on a tree: <code>map.traits</code></a></li>
<li class="chapter" data-level="3.12" data-path="maketraits.html"><a href="maketraits.html#templates-for-making-your-very-own-process"><i class="fa fa-check"></i><b>3.12</b> Templates for making your very own process</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="maketraits.html"><a href="maketraits.html#a-simple-brownian-motion-process-template"><i class="fa fa-check"></i><b>3.12.1</b> A simple Brownian Motion process template</a></li>
<li class="chapter" data-level="3.12.2" data-path="maketraits.html"><a href="maketraits.html#a-simple-ornstein-uhlenbeck-process-template"><i class="fa fa-check"></i><b>3.12.2</b> A simple Ornstein-Uhlenbeck process template</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="makemodifiers.html"><a href="makemodifiers.html"><i class="fa fa-check"></i><b>4</b> Modifying the birth-death process</a>
<ul>
<li class="chapter" data-level="4.1" data-path="makemodifiers.html"><a href="makemodifiers.html#the-default-modifier-how-the-process-is-working"><i class="fa fa-check"></i><b>4.1</b> The default modifier (how the process is working)</a></li>
<li class="chapter" data-level="4.2" data-path="makemodifiers.html"><a href="makemodifiers.html#the-branch-length-function-branch.length"><i class="fa fa-check"></i><b>4.2</b> The branch length function (<code>branch.length</code>)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="makemodifiers.html"><a href="makemodifiers.html#allowarguments"><i class="fa fa-check"></i><b>4.2.1</b> The modifier arguments</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="makemodifiers.html"><a href="makemodifiers.html#the-selection-function-selection"><i class="fa fa-check"></i><b>4.3</b> The selection function (<code>selection</code>)</a></li>
<li class="chapter" data-level="4.4" data-path="makemodifiers.html"><a href="makemodifiers.html#the-speciation-function-speciation"><i class="fa fa-check"></i><b>4.4</b> The speciation function (<code>speciation</code>)</a></li>
<li class="chapter" data-level="4.5" data-path="makemodifiers.html"><a href="makemodifiers.html#summarymodifiers"><i class="fa fa-check"></i><b>4.5</b> Summary of the inputs and outputs for the <code>branch.length</code>, <code>selection</code> and <code>speciation</code> modifiers</a></li>
<li class="chapter" data-level="4.6" data-path="makemodifiers.html"><a href="makemodifiers.html#the-condition-and-modify-functions-condition-and-modify"><i class="fa fa-check"></i><b>4.6</b> The condition and modify functions (<code>condition</code> and <code>modify</code>)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="makeevents.html"><a href="makeevents.html"><i class="fa fa-check"></i><b>5</b> Adding events to simulations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="makeevents.html"><a href="makeevents.html#target"><i class="fa fa-check"></i><b>5.1</b> Target</a></li>
<li class="chapter" data-level="5.2" data-path="makeevents.html"><a href="makeevents.html#conditions"><i class="fa fa-check"></i><b>5.2</b> Conditions</a></li>
<li class="chapter" data-level="5.3" data-path="makeevents.html"><a href="makeevents.html#modifications"><i class="fa fa-check"></i><b>5.3</b> Modifications</a></li>
<li class="chapter" data-level="5.4" data-path="makeevents.html"><a href="makeevents.html#examples"><i class="fa fa-check"></i><b>5.4</b> Examples</a></li>
<li class="chapter" data-level="5.5" data-path="makeevents.html"><a href="makeevents.html#founding"><i class="fa fa-check"></i><b>5.5</b> Founding events</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="others.html"><a href="others.html"><i class="fa fa-check"></i><b>6</b> Other functionalities</a>
<ul>
<li class="chapter" data-level="6.1" data-path="others.html"><a href="others.html#makebdparams"><i class="fa fa-check"></i><b>6.1</b> <code>make.bd.params</code></a></li>
<li class="chapter" data-level="6.2" data-path="others.html"><a href="others.html#dropthings"><i class="fa fa-check"></i><b>6.2</b> <code>drop.things</code></a></li>
<li class="chapter" data-level="6.3" data-path="others.html"><a href="others.html#treats-internal-utilities"><i class="fa fa-check"></i><b>6.3</b> <code>"treats"</code> internal utilities</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plots.html"><a href="plots.html"><i class="fa fa-check"></i><b>7</b> Plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="plots.html"><a href="plots.html#plotting-traits"><i class="fa fa-check"></i><b>7.1</b> Plotting traits</a></li>
<li class="chapter" data-level="7.2" data-path="plots.html"><a href="plots.html#plotting-treats-results"><i class="fa fa-check"></i><b>7.2</b> Plotting <code>treats</code> results</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="plots.html"><a href="plots.html#adding-dimensions-not-necessary-but-fun"><i class="fa fa-check"></i><b>7.2.1</b> Adding dimensions! Not necessary, but fun!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="specific-examples.html"><a href="specific-examples.html"><i class="fa fa-check"></i><b>8</b> Specific examples</a>
<ul>
<li class="chapter" data-level="8.1" data-path="specific-examples.html"><a href="specific-examples.html#EGrandom_ext"><i class="fa fa-check"></i><b>8.1</b> Random mass extinction after some time</a></li>
<li class="chapter" data-level="8.2" data-path="specific-examples.html"><a href="specific-examples.html#EGneg_ext"><i class="fa fa-check"></i><b>8.2</b> Species with negative trait values go extinct after a certain time</a></li>
<li class="chapter" data-level="8.3" data-path="specific-examples.html"><a href="specific-examples.html#EGbg_ext"><i class="fa fa-check"></i><b>8.3</b> Adding a background extinction after reaching a number of living taxa</a></li>
<li class="chapter" data-level="8.4" data-path="specific-examples.html"><a href="specific-examples.html#EGred_spec"><i class="fa fa-check"></i><b>8.4</b> Reducing speciation rate after a certain time</a></li>
<li class="chapter" data-level="8.5" data-path="specific-examples.html"><a href="specific-examples.html#EG_change_trait"><i class="fa fa-check"></i><b>8.5</b> Changing the trait process after some time</a></li>
<li class="chapter" data-level="8.6" data-path="specific-examples.html"><a href="specific-examples.html#EG_change_correlation"><i class="fa fa-check"></i><b>8.6</b> Changing trait correlation after reaching a trait value</a></li>
<li class="chapter" data-level="8.7" data-path="specific-examples.html"><a href="specific-examples.html#EG_change_modif"><i class="fa fa-check"></i><b>8.7</b> Event for changing a modifier: speciation event increase for species with negative values</a></li>
<li class="chapter" data-level="8.8" data-path="specific-examples.html"><a href="specific-examples.html#EG_modify_brlen"><i class="fa fa-check"></i><b>8.8</b> Changing branch length when reaching n taxa</a></li>
<li class="chapter" data-level="8.9" data-path="specific-examples.html"><a href="specific-examples.html#EG_founding_purebirth"><i class="fa fa-check"></i><b>8.9</b> Founding event: generating a subtree with no fossils</a></li>
<li class="chapter" data-level="8.10" data-path="specific-examples.html"><a href="specific-examples.html#EG_founding_traits"><i class="fa fa-check"></i><b>8.10</b> Founding event: generating a subtree a different process</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/TGuillerme/treats/" target="blank">Project GitHub page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Specific examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="maketraits" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Simulating traits<a href="maketraits.html#maketraits" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In <code>treats</code>, traits are simulating by providing a <code>traits</code> object to the <code>traits</code> argument.
This object is generated using <code>make.traits</code>.
In <code>treats</code> a trait designate any coherent character of any number of dimensions which may or may not be independent of other traits.
For example, it can be a uni-dimensional variable uncorrelated to other traits or a multi-dimensional one with different amounts of correlation.</p>
<div class="figure">
<img src="make.traits.png" alt="" />
<p class="caption"><code>make.traits</code>: The main inputs are (1) the <code>process</code>, one or more functions to describe the trait(s) as a function of previous state (<code>x0</code>) and the branch length (<code>edge.length</code>), (2) <code>n</code> the number of dimensions of the trait and (3) the starting value <code>start</code>.</p>
</div>
<div id="the-process-process" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> The process (<code>process</code>)<a href="maketraits.html#the-process-process" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The function <code>make.traits</code> allows you to design the process of a trait or a set of traits.
Here, the process of a trait designates the rules needed to generate the trait through time while simulating a phylogeny.
This process can depend on the previous state in the tree (i.e. the trait of the ancestor) and the branch length to the descendant.
One classic example is the <a href="https://en.wikipedia.org/wiki/Brownian_motion">Brownian motion process (or Weiner process)</a>.
Note that it <em>can</em> depend on both the ancestor and the branch length but does <em>not necessarily need to</em>, i.e. the process can be based only on the previous state or only on branch length or on neither.</p>
<div id="the-syntax-how-to-code-a-process" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> The syntax (how to code a process?)<a href="maketraits.html#the-syntax-how-to-code-a-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Trait processes in <code>treats</code> are functions that must always take the following arguments by default.</p>
<ul>
<li><code>x0</code>: the previous trait value(s)</li>
<li><code>edge.length</code>: the branch length</li>
<li><code>...</code>: a placeholder for any extra arguments</li>
</ul>
<p>For example, the following function would be a valid process that always generate the <em>true</em> trait value: 42!.
In this example, the process is not dependent on either the previous state (<code>x0</code>) or the branch length (<code>edge.length</code>).</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="maketraits.html#cb56-1" aria-hidden="true"></a><span class="co">## A valid (but useless?) process</span></span>
<span id="cb56-2"><a href="maketraits.html#cb56-2" aria-hidden="true"></a>valid.process &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">edge.length =</span> <span class="dv">1</span>, ...) {</span>
<span id="cb56-3"><a href="maketraits.html#cb56-3" aria-hidden="true"></a>    <span class="kw">return</span>(<span class="dv">42</span>)</span>
<span id="cb56-4"><a href="maketraits.html#cb56-4" aria-hidden="true"></a>}</span></code></pre></div>
<blockquote>
<p>Note that in this function definition the arguments <code>x0</code> and <code>edge.length</code> have a default value of <code>0</code> and <code>1</code> respectively. In practice, these arguments are effectively set to the correct values in the <code>treats</code> internal function (i.e. whatever <code>x0</code> and <code>edge.length</code> are at that specific time of the process) but providing a default can help speed up the algorithms (specifically all the internal checks).</p>
</blockquote>
<p>On the other hand, the following process (a unidimensional Brownian motion) is incorrect (it’s missing <code>edge.length</code> and <code>...</code>):</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="maketraits.html#cb57-1" aria-hidden="true"></a><span class="co">## A wrongly formatted process</span></span>
<span id="cb57-2"><a href="maketraits.html#cb57-2" aria-hidden="true"></a>invalid.process &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x0 =</span> <span class="dv">0</span>) {</span>
<span id="cb57-3"><a href="maketraits.html#cb57-3" aria-hidden="true"></a>    <span class="kw">return</span>(<span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> x0))</span>
<span id="cb57-4"><a href="maketraits.html#cb57-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>This will not work in <code>make.traits</code> (see below).</p>
</div>
<div id="using-a-process-in-treats" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Using a <code>"process"</code> in <code>treats</code><a href="maketraits.html#using-a-process-in-treats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can design your own process as a function, as long as it has a valid syntax.
Alternatively, the <code>treats</code> package has several inbuilt processes, namely a multidimensional Brownian motion (<code>BM.process</code>) or a multidimensional Ornstein-Uhlenbeck process (<code>OU.process</code>).
You can find the list of implemented processes by looking at the <code>?trait.process</code> manual page in <code>R</code>.</p>
<p>Once a process is chosen, you can feed it into the <code>make.traits</code> function:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="maketraits.html#cb58-1" aria-hidden="true"></a><span class="co">## Creating a trait object</span></span>
<span id="cb58-2"><a href="maketraits.html#cb58-2" aria-hidden="true"></a>my_trait_object &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">process =</span> BM.process)</span></code></pre></div>
<p>This creates <code>"treats"</code> <code>"traits"</code> objects that you can print and visualise using the <code>plot</code> function:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="maketraits.html#cb59-1" aria-hidden="true"></a><span class="co">## The class of the object</span></span>
<span id="cb59-2"><a href="maketraits.html#cb59-2" aria-hidden="true"></a><span class="kw">class</span>(my_trait_object)</span></code></pre></div>
<pre><code>## [1] &quot;treats&quot; &quot;traits&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="maketraits.html#cb61-1" aria-hidden="true"></a><span class="co">## What&#39;s in it?</span></span>
<span id="cb61-2"><a href="maketraits.html#cb61-2" aria-hidden="true"></a>my_trait_object</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 1 trait for 1 process (A) with one starting value (0).</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="maketraits.html#cb63-1" aria-hidden="true"></a><span class="co">## What does the process looks like</span></span>
<span id="cb63-2"><a href="maketraits.html#cb63-2" aria-hidden="true"></a><span class="kw">plot</span>(my_trait_object)</span></code></pre></div>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Note that you can see the multiple options for plotting the trait process by looking at <code>?plot.treats</code> manual. Furthermore, you can look at what’s actually in the object using this specific syntax (this applies to every object handled by the <code>treats</code> package):</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="maketraits.html#cb64-1" aria-hidden="true"></a><span class="co">## What&#39;s actually in that object?</span></span>
<span id="cb64-2"><a href="maketraits.html#cb64-2" aria-hidden="true"></a><span class="kw">print.treats</span>(my_trait_object, <span class="dt">all =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## $main
## $main$A
## $main$A$process
## function (x0 = 0, edge.length = 1, Sigma = diag(length(x0)), 
##     ...) 
## {
##     return(t(MASS::mvrnorm(n = 1, mu = x0, Sigma = Sigma * edge.length, 
##         ...)))
## }
## &lt;bytecode: 0x558c07f73e60&gt;
## &lt;environment: namespace:treats&gt;
## 
## $main$A$start
## [1] 0
## 
## $main$A$trait_id
## [1] 1
## 
## 
## 
## $background
## NULL</code></pre>
<p>As traits can get more and more complex, the automatic printing of its summary allows for a easier display of what’s in the <code>"traits"</code> object.</p>
<p>Note that it is possible to make <code>"traits"</code> objects with multiple traits and multiple processes (that can be the same or different for each trait):</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="maketraits.html#cb66-1" aria-hidden="true"></a><span class="co">## Four traits: two BM, one OU and one normal non process</span></span>
<span id="cb66-2"><a href="maketraits.html#cb66-2" aria-hidden="true"></a>four_traits &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">process =</span> <span class="kw">c</span>(BM.process,</span>
<span id="cb66-3"><a href="maketraits.html#cb66-3" aria-hidden="true"></a>                                       BM.process,</span>
<span id="cb66-4"><a href="maketraits.html#cb66-4" aria-hidden="true"></a>                                       OU.process,</span>
<span id="cb66-5"><a href="maketraits.html#cb66-5" aria-hidden="true"></a>                                       no.process))</span>
<span id="cb66-6"><a href="maketraits.html#cb66-6" aria-hidden="true"></a>four_traits</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 4 traits for 4 processes (A, B, C, D) with one starting value (0).</code></pre>
<p>You can visualise them individually using the <code>trait</code> argument in <code>plot.treats</code>:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="maketraits.html#cb68-1" aria-hidden="true"></a><span class="co">## Plot options (4 plots in one window)</span></span>
<span id="cb68-2"><a href="maketraits.html#cb68-2" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb68-3"><a href="maketraits.html#cb68-3" aria-hidden="true"></a><span class="kw">plot</span>(four_traits, <span class="dt">trait =</span> <span class="dv">1</span>)</span>
<span id="cb68-4"><a href="maketraits.html#cb68-4" aria-hidden="true"></a><span class="kw">plot</span>(four_traits, <span class="dt">trait =</span> <span class="dv">2</span>)</span>
<span id="cb68-5"><a href="maketraits.html#cb68-5" aria-hidden="true"></a><span class="kw">plot</span>(four_traits, <span class="dt">trait =</span> <span class="dv">3</span>)</span>
<span id="cb68-6"><a href="maketraits.html#cb68-6" aria-hidden="true"></a><span class="kw">plot</span>(four_traits, <span class="dt">trait =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="maketraits.html#cb69-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
</div>
<div id="the-number-of-traits-n-and-the-starting-values-start" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> The number of traits <code>n</code> and the starting values <code>start</code><a href="maketraits.html#the-number-of-traits-n-and-the-starting-values-start" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Two further important arguments are <code>n</code> the number of traits per process and <code>start</code> the starting values for all traits.
By default they are set to <code>n = 1</code> and <code>start = 0</code>.
This means that <code>make.traits</code> will assume that your processes are always unidimensional by default and that they always start with the value <code>0</code>.
It is possible however, to change these values.</p>
<p>For example you can use the following to create a three dimensional Brownian motion with each dimension starting with the value <code>1</code>:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="maketraits.html#cb70-1" aria-hidden="true"></a><span class="co">## Multidimensional Brownian motion</span></span>
<span id="cb70-2"><a href="maketraits.html#cb70-2" aria-hidden="true"></a><span class="kw">make.traits</span>(BM.process, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">start =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 3 traits for 1 process (A:3) with one starting value (1).</code></pre>
<p>Or the following with each dimensions starting with different values (respectively <code>1</code>, <code>2</code> and <code>3</code>):</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="maketraits.html#cb72-1" aria-hidden="true"></a><span class="co">## Multidimensional Brownian motion</span></span>
<span id="cb72-2"><a href="maketraits.html#cb72-2" aria-hidden="true"></a><span class="kw">make.traits</span>(BM.process, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 3 traits for 1 process (A:3) with different starting values (1,2,3).</code></pre>
<p>Note that the number of traits are applied for each process by default.
However, you can apply different number of traits for different processes:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="maketraits.html#cb74-1" aria-hidden="true"></a><span class="co">## two 3D processes (BM and OU)</span></span>
<span id="cb74-2"><a href="maketraits.html#cb74-2" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 6 traits for 2 processes (A:3, B:3) with one starting value (0).</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="maketraits.html#cb76-1" aria-hidden="true"></a><span class="co">## one 1D processes (BM) and one 4D process (OU)</span></span>
<span id="cb76-2"><a href="maketraits.html#cb76-2" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 5 traits for 2 processes (A:1, B:4) with one starting value (0).</code></pre>
<p>And starting values are distributed for all the traits or for the traits one by one:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="maketraits.html#cb78-1" aria-hidden="true"></a><span class="co">## two 3D processes (BM and OU) starting with 1</span></span>
<span id="cb78-2"><a href="maketraits.html#cb78-2" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">start =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 6 traits for 2 processes (A:3, B:3) with one starting value (1).</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="maketraits.html#cb80-1" aria-hidden="true"></a><span class="co">## two 3D processes (BM and OU) starting with values 1 to 6</span></span>
<span id="cb80-2"><a href="maketraits.html#cb80-2" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">start =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 6 traits for 2 processes (A:3, B:3) with different starting values (1,2,3,4,5,6).</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="maketraits.html#cb82-1" aria-hidden="true"></a><span class="co">## two 3D processes (BM and OU) with the two first ones starting</span></span>
<span id="cb82-2"><a href="maketraits.html#cb82-2" aria-hidden="true"></a><span class="co">## with 1 and the 4 other ones with the default (0)</span></span>
<span id="cb82-3"><a href="maketraits.html#cb82-3" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning in make.traits(c(BM.process, OU.process), n = 3, start = c(1, 1)): Only
## the first 2 starting values were supplied for a required 6 traits. The missing
## start values are set to 0.</code></pre>
<pre><code>##  ---- treats traits object ---- 
## 6 traits for 2 processes (A:3, B:3) with different starting values (1,1,0,0,0,0).</code></pre>
<div id="what-is-a-trait-in-treats" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> What is a trait in <code>treats</code>?<a href="maketraits.html#what-is-a-trait-in-treats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Because it would be impossible to accommodate all definitions of a trait in <code>treats</code> we chose an arbitrary one: a trait is whatever you define as a trait!
A trait can be uni-dimensional as the measurement of a feature of an organism (e.g. leaf surface, femur length, etc.) but can also be a multi-dimensional description of a feature, for example in 3D geometric morphometric context, a trait could be defined as “position of landmark X” (which will be a trait with three dimensions, <em>x</em>, <em>y</em> and <em>z</em>) or in ecology, the location of a plant can be expressed as latitude and longitude coordinates.
In <code>treats</code>, the <strong>process</strong> corresponds to this trait definition (e.g. a process can be of n-dimensions and represents one organisms feature) and the <strong>traits</strong> represents the number of dimensions in total.
So in the examples above, this is how the following traits are interpreted by <code>treats</code>:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="maketraits.html#cb85-1" aria-hidden="true"></a><span class="co">## Three traits with one process:</span></span>
<span id="cb85-2"><a href="maketraits.html#cb85-2" aria-hidden="true"></a><span class="kw">make.traits</span>(BM.process, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb85-3"><a href="maketraits.html#cb85-3" aria-hidden="true"></a><span class="co">## Six traits with two processes:</span></span>
<span id="cb85-4"><a href="maketraits.html#cb85-4" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="dv">3</span>)</span>
<span id="cb85-5"><a href="maketraits.html#cb85-5" aria-hidden="true"></a><span class="co">## Five traits with two processes</span></span>
<span id="cb85-6"><a href="maketraits.html#cb85-6" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))</span></code></pre></div>
</div>
</div>
<div id="multidimensional-traits-and-correlations" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Multidimensional traits and correlations<a href="maketraits.html#multidimensional-traits-and-correlations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As shown in the example above, a trait can be made multidimensional by using the <code>n</code> argument specifically passed to a <code>process</code>.
However, in this case, traits are simulated independently of each other.
It is possible to include correlation by designing a multidimensional trait <code>process</code> directly generating the correlation between within the dimensions of the process.
Alternatively, the inbuilt <code>BM.process</code> and <code>OU.process</code> can intake a correlation matrix to simulate traits independtly but with a correlation coefficient (see <a href="specific-examples.html#EG_change_correlation">this illustration with an event</a>).</p>
</div>
<div id="extra-argument-for-the-processes-with-process.args" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Extra argument for the processes with <code>process.args</code><a href="maketraits.html#extra-argument-for-the-processes-with-process.args" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also feed extra arguments to your process(es) functions.
For example, the inbuilt process <code>no.process</code> (that is just a number generator not based on the previous value <code>x0</code> or the branch length) can take a specific random number generator as a function:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="maketraits.html#cb86-1" aria-hidden="true"></a><span class="co">## no process trait using the normal distribution (default)</span></span>
<span id="cb86-2"><a href="maketraits.html#cb86-2" aria-hidden="true"></a><span class="kw">make.traits</span>(no.process, <span class="dt">process.args =</span> <span class="kw">list</span>(<span class="dt">fun =</span> rnorm))</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 1 trait for 1 process (A) with one starting value (0).
## process A uses the following extra argument: fun;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="maketraits.html#cb88-1" aria-hidden="true"></a><span class="co">## no process trait using the uniform distribution</span></span>
<span id="cb88-2"><a href="maketraits.html#cb88-2" aria-hidden="true"></a><span class="co">## bounded between 1 and 100</span></span>
<span id="cb88-3"><a href="maketraits.html#cb88-3" aria-hidden="true"></a><span class="kw">make.traits</span>(no.process, <span class="dt">process.args =</span> <span class="kw">list</span>(<span class="dt">fun =</span> runif, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>))</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 1 trait for 1 process (A) with one starting value (0).
## process A uses the following extra arguments: fun,min,max;</code></pre>
<p>You can also add multiple extra arguments for multiple processes giving them as a list.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="maketraits.html#cb90-1" aria-hidden="true"></a><span class="co">## Two traits with no process:one normal and one uniform (1,100)</span></span>
<span id="cb90-2"><a href="maketraits.html#cb90-2" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="dt">process =</span> <span class="kw">c</span>(no.process, no.process),</span>
<span id="cb90-3"><a href="maketraits.html#cb90-3" aria-hidden="true"></a>            <span class="dt">process.args =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">fun =</span> rnorm),</span>
<span id="cb90-4"><a href="maketraits.html#cb90-4" aria-hidden="true"></a>                                <span class="kw">list</span>(<span class="dt">fun =</span> runif, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>)))</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 2 traits for 2 processes (A, B) with one starting value (0).
## process A uses the following extra argument: fun;
## process B uses the following extra arguments: fun,min,max;</code></pre>
<p>If one process does not need extra argument you must still give it an extra <code>NULL</code> process argument:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="maketraits.html#cb92-1" aria-hidden="true"></a><span class="co">## Three traits with no process:</span></span>
<span id="cb92-2"><a href="maketraits.html#cb92-2" aria-hidden="true"></a><span class="co">## one default, one lognormal and one uniform (1,100)</span></span>
<span id="cb92-3"><a href="maketraits.html#cb92-3" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="dt">process      =</span> <span class="kw">c</span>(no.process, no.process, no.process),</span>
<span id="cb92-4"><a href="maketraits.html#cb92-4" aria-hidden="true"></a>            <span class="dt">process.args =</span> <span class="kw">list</span>(<span class="co">## Extra arguments for the first process (none)</span></span>
<span id="cb92-5"><a href="maketraits.html#cb92-5" aria-hidden="true"></a>                                <span class="kw">list</span>(<span class="ot">NULL</span>),</span>
<span id="cb92-6"><a href="maketraits.html#cb92-6" aria-hidden="true"></a>                                <span class="co">## Extra arguments for the second process</span></span>
<span id="cb92-7"><a href="maketraits.html#cb92-7" aria-hidden="true"></a>                                <span class="kw">list</span>(<span class="dt">fun =</span> rlnorm),</span>
<span id="cb92-8"><a href="maketraits.html#cb92-8" aria-hidden="true"></a>                                <span class="co">## Extra arguments for the third process</span></span>
<span id="cb92-9"><a href="maketraits.html#cb92-9" aria-hidden="true"></a>                                <span class="kw">list</span>(<span class="dt">fun =</span> runif, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>)))</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 3 traits for 3 processes (A, B, C) with one starting value (0).
## process B uses the following extra argument: fun;
## process C uses the following extra arguments: fun,min,max;</code></pre>
</div>
<div id="naming-the-traits-with-trait.names" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Naming the traits with <code>trait.names</code><a href="maketraits.html#naming-the-traits-with-trait.names" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As traits become more and more complex, it can be useful to give clearer names to each process.
This is easily done using the <code>trait.names</code> argument that attributes one name per process:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="maketraits.html#cb94-1" aria-hidden="true"></a><span class="co">## A simple trait with a proper name</span></span>
<span id="cb94-2"><a href="maketraits.html#cb94-2" aria-hidden="true"></a>simple_trait &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">trait.names =</span> <span class="st">&quot;1D Brownian Motion&quot;</span>)</span>
<span id="cb94-3"><a href="maketraits.html#cb94-3" aria-hidden="true"></a>simple_trait</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 1 trait for 1 process (1D Brownian Motion) with one starting value (0).</code></pre>
<p>This becomes more useful if we use the complex example above:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="maketraits.html#cb96-1" aria-hidden="true"></a><span class="co">## Three named traits with no process:</span></span>
<span id="cb96-2"><a href="maketraits.html#cb96-2" aria-hidden="true"></a><span class="co">## one default, one lognormal and one uniform (1,100)</span></span>
<span id="cb96-3"><a href="maketraits.html#cb96-3" aria-hidden="true"></a><span class="kw">make.traits</span>(<span class="dt">process      =</span> <span class="kw">c</span>(no.process, no.process, no.process),</span>
<span id="cb96-4"><a href="maketraits.html#cb96-4" aria-hidden="true"></a>            <span class="dt">process.args =</span> <span class="kw">list</span>(<span class="co">## Extra arguments for the first process (none)</span></span>
<span id="cb96-5"><a href="maketraits.html#cb96-5" aria-hidden="true"></a>                                <span class="kw">list</span>(<span class="ot">NULL</span>),</span>
<span id="cb96-6"><a href="maketraits.html#cb96-6" aria-hidden="true"></a>                                <span class="co">## Extra arguments for the second process</span></span>
<span id="cb96-7"><a href="maketraits.html#cb96-7" aria-hidden="true"></a>                                <span class="kw">list</span>(<span class="dt">fun =</span> rlnorm),</span>
<span id="cb96-8"><a href="maketraits.html#cb96-8" aria-hidden="true"></a>                                <span class="co">## Extra arguments for the third process</span></span>
<span id="cb96-9"><a href="maketraits.html#cb96-9" aria-hidden="true"></a>                                <span class="kw">list</span>(<span class="dt">fun =</span> runif, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>)),</span>
<span id="cb96-10"><a href="maketraits.html#cb96-10" aria-hidden="true"></a>            <span class="co">## Naming each trait</span></span>
<span id="cb96-11"><a href="maketraits.html#cb96-11" aria-hidden="true"></a>            <span class="dt">trait.names  =</span> <span class="kw">c</span>(<span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;LogNormal&quot;</span>, <span class="st">&quot;Uniform(1,100)&quot;</span>))</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 3 traits for 3 processes (Normal, LogNormal, Uniform(1,100)) with one starting value (0).
## process LogNormal uses the following extra argument: fun;
## process Uniform(1,100) uses the following extra arguments: fun,min,max;</code></pre>
</div>
<div id="combining-multiple-traits-with-add" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Combining multiple traits with <code>add</code><a href="maketraits.html#combining-multiple-traits-with-add" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also add traits to already existing trait objects using the simple <code>add</code> option.
This option just takes a <code>"treats"</code> <code>"traits"</code> object and the additional process(es) will be added to it.
For example:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="maketraits.html#cb98-1" aria-hidden="true"></a><span class="co">## Creating a simple default Brownian motion</span></span>
<span id="cb98-2"><a href="maketraits.html#cb98-2" aria-hidden="true"></a>one_process &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">trait.names =</span> <span class="st">&quot;BM&quot;</span>)</span>
<span id="cb98-3"><a href="maketraits.html#cb98-3" aria-hidden="true"></a></span>
<span id="cb98-4"><a href="maketraits.html#cb98-4" aria-hidden="true"></a><span class="co">## Creating a new trait (a 3D OU.process)</span></span>
<span id="cb98-5"><a href="maketraits.html#cb98-5" aria-hidden="true"></a><span class="co">## and adding the previous one</span></span>
<span id="cb98-6"><a href="maketraits.html#cb98-6" aria-hidden="true"></a>two_processes &lt;-<span class="st"> </span><span class="kw">make.traits</span>(OU.process, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">add =</span> one_process,</span>
<span id="cb98-7"><a href="maketraits.html#cb98-7" aria-hidden="true"></a>                             <span class="dt">trait.names =</span> <span class="st">&quot;3D OU&quot;</span>)</span>
<span id="cb98-8"><a href="maketraits.html#cb98-8" aria-hidden="true"></a></span>
<span id="cb98-9"><a href="maketraits.html#cb98-9" aria-hidden="true"></a><span class="co">## Only one process</span></span>
<span id="cb98-10"><a href="maketraits.html#cb98-10" aria-hidden="true"></a>one_process</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 1 trait for 1 process (BM) with one starting value (0).</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="maketraits.html#cb100-1" aria-hidden="true"></a><span class="co">## The two processes</span></span>
<span id="cb100-2"><a href="maketraits.html#cb100-2" aria-hidden="true"></a>two_processes</span></code></pre></div>
<pre><code>##  ---- treats traits object ---- 
## 4 traits for 2 processes (BM:1, 3D OU:3) with one starting value (0).</code></pre>
</div>
<div id="using-a-background-trait" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Using a background trait<a href="maketraits.html#using-a-background-trait" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>traits</code> objects also allow a background trait to be used when traits are simulated (<a href="index.html#bdalgorithm">step 3 here</a>).
This allows traits to be simulated for <em>all</em> tips whenever a trait is generated for one tip.
This can be useful for keeping track of trait values along the simulation (<em>cf</em> just at bifurcating nodes).
The <code>background</code> argument takes any output from the <code>make.traits</code> function in a nested way:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="maketraits.html#cb102-1" aria-hidden="true"></a><span class="co">## Generating a default BM trait:</span></span>
<span id="cb102-2"><a href="maketraits.html#cb102-2" aria-hidden="true"></a>BM_trait &lt;-<span class="st"> </span><span class="kw">make.traits</span>()</span>
<span id="cb102-3"><a href="maketraits.html#cb102-3" aria-hidden="true"></a><span class="co">## Generating an OU trait with a background BM trait</span></span>
<span id="cb102-4"><a href="maketraits.html#cb102-4" aria-hidden="true"></a>my_trait &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">process =</span> OU.process, <span class="dt">background =</span> BM_trait) </span></code></pre></div>
<p>Note that technically you can nest as many background traits as you want (e.g. <code>make.traits(background = make.traits(background = make.traits(...)))</code> is valid).
However, you should always make sure that the background trait has the same dimensions as the main trait.
When using a trait with background, your tree will have internal singleton nodes (i.e. nodes linking to one ancestor and only one descendant).
You can remove these nodes using the <a href="others.html#dropthings"><code>drop.things</code> function</a>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="maketraits.html#cb103-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb103-2"><a href="maketraits.html#cb103-2" aria-hidden="true"></a><span class="co">## Generating a pure birth tree with the background trait</span></span>
<span id="cb103-3"><a href="maketraits.html#cb103-3" aria-hidden="true"></a>tree_bkg &lt;-<span class="st"> </span><span class="kw">treats</span>(<span class="dt">stop.rule =</span> <span class="kw">list</span>(<span class="dt">max.taxa =</span> <span class="dv">20</span>),</span>
<span id="cb103-4"><a href="maketraits.html#cb103-4" aria-hidden="true"></a>                 <span class="dt">traits =</span> my_trait)</span>
<span id="cb103-5"><a href="maketraits.html#cb103-5" aria-hidden="true"></a><span class="co">## This tree has many internal singleton nodes</span></span>
<span id="cb103-6"><a href="maketraits.html#cb103-6" aria-hidden="true"></a><span class="kw">plot</span>(tree_bkg)</span></code></pre></div>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="saving-trait-values-at-different-time-steps" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Saving trait values at different time steps<a href="maketraits.html#saving-trait-values-at-different-time-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also simulate a tree by generating traits at specific time steps with the <code>save.steps</code> option in <code>treats</code>.
This will apply the <code>traits</code> object to all lineages currently alive at the required time steps.
These time steps can be either regular by providing a single numeric value; e.g. <code>save.steps = 0.1</code> will take a snapshot of the trait values every 0.1 units of time, or specific, by providing a specific set of values; e.g. <code>save.steps = c(1, 1.2, 3)</code> will take a snapshot of the trait values at the required time steps.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="maketraits.html#cb104-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb104-2"><a href="maketraits.html#cb104-2" aria-hidden="true"></a><span class="co">## Generating a birth-death tree with a BM trait and saving steps at specific times</span></span>
<span id="cb104-3"><a href="maketraits.html#cb104-3" aria-hidden="true"></a>tree_steps &lt;-<span class="st"> </span><span class="kw">treats</span>(<span class="dt">stop.rule  =</span> <span class="kw">list</span>(<span class="dt">max.time =</span> <span class="dv">3</span>),</span>
<span id="cb104-4"><a href="maketraits.html#cb104-4" aria-hidden="true"></a>                   <span class="dt">bd.params  =</span> <span class="kw">list</span>(<span class="dt">speciation =</span> <span class="dv">1</span>, <span class="dt">extinction =</span> <span class="fl">0.1</span>),</span>
<span id="cb104-5"><a href="maketraits.html#cb104-5" aria-hidden="true"></a>                   <span class="dt">traits     =</span> <span class="kw">make.traits</span>(),</span>
<span id="cb104-6"><a href="maketraits.html#cb104-6" aria-hidden="true"></a>                   <span class="dt">save.steps =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb104-7"><a href="maketraits.html#cb104-7" aria-hidden="true"></a><span class="co">## This also creates internal singleton nodes</span></span>
<span id="cb104-8"><a href="maketraits.html#cb104-8" aria-hidden="true"></a><span class="kw">plot</span>(tree_steps)</span>
<span id="cb104-9"><a href="maketraits.html#cb104-9" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">lwd =</span> <span class="fl">0.5</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="traits-implemented-in-treats" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Traits implemented in <code>treats</code><a href="maketraits.html#traits-implemented-in-treats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you don’t want to design your own trait process, you can use one of the following trait processes that are currently implemented in <code>treats</code>. You can find more information about their many options using their specific manuals in R or the generic <code>?trait.process</code>:</p>
<ul>
<li><code>BM.process</code>: this is the well known <a href="https://en.wikipedia.org/wiki/Brownian_motion">Brownian motion process</a>.</li>
</ul>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<ul>
<li><code>OU.process</code>: this is the equally famous <a href="https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process">Ornstein–Uhlenbeck process</a>.</li>
</ul>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<ul>
<li><code>no.process</code>: this process has… no process. In other words, this is a non time dependent process; the simulated value does not depends on the ancestors’ value nor the branch length. It’s basically a place holder for a random sampling function like <code>rnorm</code> (default), <code>runif</code>, <code>rlnorm</code>, etc.</li>
</ul>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<ul>
<li><code>multi.peak.process</code>: this process is a modified version of the <code>OU.process</code> that can take multiple local long-term mean values. The default OU process has one long-term mean towards which the values are drawn with the alpha parameter (the elastic band). The single long-term mean is usually 0. However, with this <code>multi.peak.process</code> we can set multiple values towards which values can be attracted with the same alpha parameter.</li>
</ul>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<ul>
<li><code>repulsion.process</code>: this is a modified version of the <code>BM.process</code> where instead of accumulating gradually through time, new trait values are more likely to be different to the traits of their ancestor following a <code>repulsion</code> parameter.</li>
</ul>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<ul>
<li><code>discrete.process</code>: this one generates discrete trait values based on a transition matrix (you can use the utility function <code>transition.matrix</code> to generate one).</li>
</ul>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<p>Of course here the plotting of a discrete trait is not that informative…</p>
</div>
<div id="testing-the-traits-with-test" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Testing the traits with <code>test</code><a href="maketraits.html#testing-the-traits-with-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>This bit is still in development.</strong>
We highly suggest leaving <code>test = TRUE</code> so that <code>make.traits</code> returns an error if a process or its additional arguments (<code>process.args</code>) are not formatted correctly.
<code>make.traits</code> will send an error if the trait cannot be directly passed to <code>treats</code>.
However, in some specific cases (again, probably mainly for development and debugging) it could be useful to skip the tests using <code>test = FALSE</code>.</p>
</div>
<div id="mapping-traits-on-a-tree-map.traits" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> Mapping traits on a tree: <code>map.traits</code><a href="maketraits.html#mapping-traits-on-a-tree-map.traits" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Although <code>make.traits</code> is mainly designed for <code>treats</code> simulations, i.e. simulating both the trees AND the traits at the same time, it is possible to use an already simulated or estimated tree and generating one or more traits on it using the <code>map.traits</code> function. This function takes the trait input as a <code>"traits"</code> object (from <code>make.traits</code>) and a tree topology with branch length. Note that you can also use <code>"traits"</code> objects with multiple or multi-dimensional traits as well as multiple phylogenies (<code>"multiPhylo"</code>).</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="maketraits.html#cb105-1" aria-hidden="true"></a><span class="co">## Simulating a random tree with branch length</span></span>
<span id="cb105-2"><a href="maketraits.html#cb105-2" aria-hidden="true"></a>my_tree &lt;-<span class="st"> </span><span class="kw">rtree</span>(<span class="dv">20</span>)</span>
<span id="cb105-3"><a href="maketraits.html#cb105-3" aria-hidden="true"></a></span>
<span id="cb105-4"><a href="maketraits.html#cb105-4" aria-hidden="true"></a><span class="co">## Creating three different traits objects:</span></span>
<span id="cb105-5"><a href="maketraits.html#cb105-5" aria-hidden="true"></a><span class="co">## A Brownian Motion</span></span>
<span id="cb105-6"><a href="maketraits.html#cb105-6" aria-hidden="true"></a>bm_process &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">process =</span> BM.process)</span>
<span id="cb105-7"><a href="maketraits.html#cb105-7" aria-hidden="true"></a><span class="co">## An Ornstein-Uhlenbeck process</span></span>
<span id="cb105-8"><a href="maketraits.html#cb105-8" aria-hidden="true"></a>ou_process &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">process =</span> OU.process)</span>
<span id="cb105-9"><a href="maketraits.html#cb105-9" aria-hidden="true"></a><span class="co">## No process (just randomly drawing values from a normal distribution)</span></span>
<span id="cb105-10"><a href="maketraits.html#cb105-10" aria-hidden="true"></a>no_process &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">process =</span> no.process)</span>
<span id="cb105-11"><a href="maketraits.html#cb105-11" aria-hidden="true"></a></span>
<span id="cb105-12"><a href="maketraits.html#cb105-12" aria-hidden="true"></a><span class="co">## Mapping the three traits on the phylogeny</span></span>
<span id="cb105-13"><a href="maketraits.html#cb105-13" aria-hidden="true"></a>bm_traits &lt;-<span class="st"> </span><span class="kw">map.traits</span>(bm_process, my_tree)</span>
<span id="cb105-14"><a href="maketraits.html#cb105-14" aria-hidden="true"></a>ou_traits &lt;-<span class="st"> </span><span class="kw">map.traits</span>(ou_process, my_tree)</span>
<span id="cb105-15"><a href="maketraits.html#cb105-15" aria-hidden="true"></a>no_traits &lt;-<span class="st"> </span><span class="kw">map.traits</span>(no_process, my_tree)</span>
<span id="cb105-16"><a href="maketraits.html#cb105-16" aria-hidden="true"></a></span>
<span id="cb105-17"><a href="maketraits.html#cb105-17" aria-hidden="true"></a><span class="co">## Plotting the topology and the different traits</span></span>
<span id="cb105-18"><a href="maketraits.html#cb105-18" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb105-19"><a href="maketraits.html#cb105-19" aria-hidden="true"></a><span class="kw">plot</span>(my_tree, <span class="dt">main =</span> <span class="st">&quot;Base topology&quot;</span>)</span>
<span id="cb105-20"><a href="maketraits.html#cb105-20" aria-hidden="true"></a><span class="kw">plot</span>(bm_traits, <span class="dt">main =</span> <span class="st">&quot;Mapped BM&quot;</span>)</span>
<span id="cb105-21"><a href="maketraits.html#cb105-21" aria-hidden="true"></a><span class="kw">plot</span>(ou_traits, <span class="dt">main =</span> <span class="st">&quot;Mapped OU&quot;</span>)</span>
<span id="cb105-22"><a href="maketraits.html#cb105-22" aria-hidden="true"></a><span class="kw">plot</span>(no_traits, <span class="dt">main =</span> <span class="st">&quot;Mapped normal trait&quot;</span>)</span></code></pre></div>
<p><img src="treats_manual_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
<div id="templates-for-making-your-very-own-process" class="section level2 hasAnchor" number="3.12">
<h2><span class="header-section-number">3.12</span> Templates for making your very own process<a href="maketraits.html#templates-for-making-your-very-own-process" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As detailed above, any process of your own design will work as long as it is a function that takes at least the arguments <code>x0</code> and <code>edge.length</code>.
You can be imaginative and creative when designing your own process but here are two detailed example functions for a unidimensional Brownian Motion and Ornstein-Uhlenbeck process that you can use for a start (or not).
Remember it is good practice for <code>treats</code> processes to set all the arguments with default values (just in case).</p>
<blockquote>
<p>Note that the functions below are not equal to the already implemented <code>BM.process</code> and <code>OU.process</code> but an easier to edit version that you can use as a template:</p>
</blockquote>
<div id="a-simple-brownian-motion-process-template" class="section level3 hasAnchor" number="3.12.1">
<h3><span class="header-section-number">3.12.1</span> A simple Brownian Motion process template<a href="maketraits.html#a-simple-brownian-motion-process-template" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="maketraits.html#cb106-1" aria-hidden="true"></a><span class="co">## A simple Brownian motion process</span></span>
<span id="cb106-2"><a href="maketraits.html#cb106-2" aria-hidden="true"></a>my.BM.process &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">edge.length =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">1</span>, ...) {</span>
<span id="cb106-3"><a href="maketraits.html#cb106-3" aria-hidden="true"></a>    <span class="co">## Drawing a random number from a normal distribution</span></span>
<span id="cb106-4"><a href="maketraits.html#cb106-4" aria-hidden="true"></a>    <span class="co">## with x0 as the and a given standard deviation</span></span>
<span id="cb106-5"><a href="maketraits.html#cb106-5" aria-hidden="true"></a>    <span class="co">## and depending on branch (edge) length</span></span>
<span id="cb106-6"><a href="maketraits.html#cb106-6" aria-hidden="true"></a>    result &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> x0, <span class="dt">sd =</span> <span class="kw">sqrt</span>(sd<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>edge.length))</span>
<span id="cb106-7"><a href="maketraits.html#cb106-7" aria-hidden="true"></a></span>
<span id="cb106-8"><a href="maketraits.html#cb106-8" aria-hidden="true"></a>    <span class="co">## Return the number</span></span>
<span id="cb106-9"><a href="maketraits.html#cb106-9" aria-hidden="true"></a>    <span class="kw">return</span>(result)</span>
<span id="cb106-10"><a href="maketraits.html#cb106-10" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="a-simple-ornstein-uhlenbeck-process-template" class="section level3 hasAnchor" number="3.12.2">
<h3><span class="header-section-number">3.12.2</span> A simple Ornstein-Uhlenbeck process template<a href="maketraits.html#a-simple-ornstein-uhlenbeck-process-template" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="maketraits.html#cb107-1" aria-hidden="true"></a><span class="co">## A simple Ornstein-Uhlenbeck motion process</span></span>
<span id="cb107-2"><a href="maketraits.html#cb107-2" aria-hidden="true"></a>my.OU.process &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">edge.length =</span> <span class="dv">1</span>, <span class="dt">var =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, ...) {</span>
<span id="cb107-3"><a href="maketraits.html#cb107-3" aria-hidden="true"></a>    <span class="co">## Calculate the mean based on alpha</span></span>
<span id="cb107-4"><a href="maketraits.html#cb107-4" aria-hidden="true"></a>    mean &lt;-<span class="st"> </span>x0 <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>alpha)</span>
<span id="cb107-5"><a href="maketraits.html#cb107-5" aria-hidden="true"></a>    <span class="co">## Calculate the standard deviation based on alpha and the variance</span></span>
<span id="cb107-6"><a href="maketraits.html#cb107-6" aria-hidden="true"></a>    sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(var<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>alpha) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>alpha)))</span>
<span id="cb107-7"><a href="maketraits.html#cb107-7" aria-hidden="true"></a>    <span class="co">## Draw a random number from a normal distribution</span></span>
<span id="cb107-8"><a href="maketraits.html#cb107-8" aria-hidden="true"></a>    <span class="co">## using this mean and standard deviation</span></span>
<span id="cb107-9"><a href="maketraits.html#cb107-9" aria-hidden="true"></a>    <span class="co">## and depending on branch (edge) length</span></span>
<span id="cb107-10"><a href="maketraits.html#cb107-10" aria-hidden="true"></a>    result &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> <span class="kw">sqrt</span>(sd<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>edge.length))</span>
<span id="cb107-11"><a href="maketraits.html#cb107-11" aria-hidden="true"></a></span>
<span id="cb107-12"><a href="maketraits.html#cb107-12" aria-hidden="true"></a>    <span class="co">## Return the number</span></span>
<span id="cb107-13"><a href="maketraits.html#cb107-13" aria-hidden="true"></a>    <span class="kw">return</span>(result)</span>
<span id="cb107-14"><a href="maketraits.html#cb107-14" aria-hidden="true"></a>}</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gettingstarted.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="makemodifiers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TGuillerme/treats/inst/gitbook/edit/master/02_make.traits.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
